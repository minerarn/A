<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>类别管理 - 管理后台</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>博文类别管理</h1>
        <a class="btn btn-primary" th:href="@{/admin/types/new}">+ 新增类别</a>
    </div>

    <div class="card shadow-sm">
        <div class="card-body">
            <table class="table table-hover align-middle">
                <thead class="table-light">
                <tr>
                    <th>ID</th>
                    <th>类别名称</th>
                    <th>博文统计</th> <th>当前状态</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="t : ${types}">
                    <td th:text="${t.id}"></td>
                    <td>
                        <a th:href="@{'/types/' + ${t.id} + '/posts'}"
                           th:text="${t.name}" class="text-decoration-none fw-bold"></a>
                    </td>
                    <td>
                        <span class="badge bg-info text-dark"
                              th:text="${t.postCount != null ? t.postCount : 0} + ' 篇'">0 篇</span>
                    </td>
                    <td>
                        <span th:if="${t.enabled == 1}" class="badge bg-success">已启用</span>
                        <span th:if="${t.enabled != 1}" class="badge bg-secondary">已禁用</span>
                    </td>
                    <td>
                        <div class="btn-group">
                            <a th:href="@{'/admin/types/edit/' + ${t.id}}"
                               class="btn btn-sm btn-outline-secondary">编辑</a>

                            <form th:action="@{'/admin/types/delete/' + ${t.id}}" method="post"
                                  onsubmit="return confirm('确定要删除该类别吗？删除后不可恢复！')"
                                  style="display:inline">
                                <button class="btn btn-sm btn-outline-danger" type="submit"
                                        th:disabled="${t.postCount > 0}"
                                        th:title="${t.postCount > 0 ? '该类别下已有博文，无法直接删除' : '点击删除'}">
                                    删除
                                </button>
                            </form>
                        </div>
                    </td>
                </tr>
                <tr th:if="${#lists.isEmpty(types)}">
                    <td colspan="5" class="text-center text-muted">暂无类别数据，请点击上方按钮新增。</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="mt-3">
        <a class="btn btn-link text-decoration-none" th:href="@{/admin/posts}">← 返回博文管理</a>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>